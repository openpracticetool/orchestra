<div class="pf-c-background-image">
  <svg xmlns="http://www.w3.org/2000/svg" class="pf-c-background-image__filter" width="0" height="0">
    <filter id="image_overlay">
      <feColorMatrix type="matrix" values="1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0"></feColorMatrix>
      <feComponentTransfer color-interpolation-filters="sRGB" result="duotone">
        <feFuncR type="table" tableValues="0.086274509803922 0.43921568627451"></feFuncR>
        <feFuncG type="table" tableValues="0.086274509803922 0.43921568627451"></feFuncG>
        <feFuncB type="table" tableValues="0.086274509803922 0.43921568627451"></feFuncB>
        <feFuncA type="table" tableValues="0 1"></feFuncA>
      </feComponentTransfer>
    </filter>
  </svg>
</div>
<div class="pf-c-login">
  <div class="pf-c-login__container">
    <header class="pf-c-login__header pf-u-mb-lg">
      Open Practice Tool
    </header>
    <main class="pf-c-login__main">
      <header class="pf-c-login__main-header" *ngIf="!isLogged()">
        <h1 class="pf-c-title pf-m-3xl">Log in to your account</h1>
        <p class="pf-c-login__main-header-desc">To get access to your sessions and create new ones, please log in.</p>
      </header>
      <header class="pf-c-login__main-header" *ngIf="isLogged()">
        <h1 class="pf-c-title pf-m-3xl">You are already in</h1>
        <p class="pf-c-login__main-header-desc">You are logged in with the following account:</p>
      </header>
      <div class="pf-c-login__main-body">
        <form novalidate class="pf-c-form" [formGroup]="loginForm" (ngSubmit)="doLogin(loginForm.value)" *ngIf="!isLogged()">
          <app-text-field
            name="email"
            [formControl]="loginForm.controls['email']"
          >
            Email
          </app-text-field>
          <app-text-field
            name="password"
            type="password"
            [formControl]="loginForm.controls['password']"
          >
            Password
          </app-text-field>
          <div class="pf-c-alert pf-m-danger" aria-label="Danger alert" *ngIf="errorMessage">
            <div class="pf-c-alert__icon">
              <i class="fas fa-fw fa-exclamation-circle" aria-hidden="true"></i>
            </div>
            <p class="pf-c-alert__title">
              {{ errorMessage }}
            </p>
          </div>
          <div class="pf-c-form__group pf-m-action pf-u-text-align-center">
            <span class="pf-c-spinner pf-m-xl" role="progressbar" aria-valuetext="Loading..." *ngIf="loginForm.disabled">
              <span class="pf-c-spinner__clipper"></span>
              <span class="pf-c-spinner__lead-ball"></span>
              <span class="pf-c-spinner__tail-ball"></span>
            </span>
            <button class="pf-c-button pf-m-primary pf-m-block" type="submit" *ngIf="!loginForm.disabled" [disabled]="loginForm.invalid">
              Log in
            </button>
          </div>
        </form>
        <div *ngIf="isLogged()" class="pf-u-text-align-center">
          <span class="pf-u-display-block pf-u-p-lg">{{ user ? user.name || user.email : 'loading ...' }}</span>
          <button class="pf-c-button pf-m-primary pf-m-block pf-u-mb-md" type="button" routerLink="../dashboard">
            Go to my workspace
          </button>
          <button class="pf-c-button pf-m-danger pf-m-block" type="button" (click)="logout()">
            Log in with another account
          </button>
        </div>
      </div>
      <footer class="pf-c-login__main-footer">
        <div class="pf-c-login__main-footer-band">
          <p class="pf-c-login__main-footer-band-item">Need an account?
            <a [routerLink]="['/register']">
              Sign up.
            </a>
          </p>
          <!-- <p class="pf-c-login__main-footer-band-item">
            <a href="#">Forgot username or password?</a>
          </p> -->
        </div>
      </footer>
    </main>
    <footer class="pf-c-login__footer">
      <p>This is an open source tool where you can work collaboratively with your teammates, please get involved with us to improve your experience giving feedback.</p>
      <ul class="pf-c-list pf-m-inline">
        <li>
          <a class="pf-c-button pf-m-plain" type="button" aria-label="Remove" href="https://github.com/openpracticetool">
            <i class="fab fa-github" aria-hidden="true"></i>
            Github
          </a>
        </li>
      </ul>
    </footer>
  </div>
</div>
